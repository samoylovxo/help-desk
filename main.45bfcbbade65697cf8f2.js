!function(){"use strict";var t,e={9207:function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var e=function(){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),this.url=t,this.contentTypeHeader={"Content-Type":"application/json"}}var i,n,s;return i=e,(n=[{key:"getAllTickets",value:function(){return fetch("".concat(this.url,"?method=allTickets"),{method:"GET"})}},{key:"createTicket",value:function(t){return fetch("".concat(this.url,"?method=createTicket&name=").concat(t.name,"&description=").concat(t.description),{method:"POST",headers:this.contentTypeHeader})}},{key:"getTicketById",value:function(t){return fetch("".concat(this.url,"?method=ticketById&id=").concat(t),{method:"GET"})}},{key:"remove",value:function(t){return fetch("".concat(this.url,"?method=removeTicket&id=").concat(t),{method:"DELETE",headers:this.contentTypeHeader})}},{key:"editTicket",value:function(t,e){return fetch("".concat(this.url,"?method=editTicket&name=").concat(e.name,"&description=").concat(e.description,"&id=").concat(t),{method:"PUT",headers:this.contentTypeHeader})}}])&&t(i.prototype,n),s&&t(i,s),e}();function i(t,e,i,n,s,r,c){try{var o=t[r](c),a=o.value}catch(t){return void i(t)}o.done?e(a):Promise.resolve(a).then(n,s)}function n(t){return function(){var e=this,n=arguments;return new Promise((function(s,r){var c=t.apply(e,n);function o(t){i(c,s,r,o,a,"next",t)}function a(t){i(c,s,r,o,a,"throw",t)}o(void 0)}))}}function s(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var r=new(function(){function t(i,n){var s=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),"string"==typeof i&&(this.element=document.querySelector(i)),this.api=new e(n),this.ticket=null,this.isEditTicket=null,this.ticketRow=this.element.querySelector(".desk__ticket-row"),this.addTicketBtn=this.element.querySelector(".add-ticket-btn"),this.changeTicketBtn=this.element.querySelectorAll(".desk__ticket-edit"),this.closeModalBtns=this.element.querySelectorAll(".btn-close"),this.modalAdd=this.element.querySelector(".desk__modal-add"),this.modalDelete=this.element.querySelector(".desk__modal-delete"),this.modalTitle=this.element.querySelector(".desk__modal-title"),this.inputName=this.element.querySelector(".desk__input-name"),this.inputDesc=this.element.querySelector(".desk__input-desc"),this.from=this.element.querySelector(".desk__from"),this.btnOk=this.element.querySelector(".btn-ok"),this.init=this.init.bind(this),this.renderTickets=this.renderTickets.bind(this),this.removeTicket=this.removeTicket.bind(this),this.showModal=this.showModal.bind(this),this.createTicket=this.createTicket.bind(this),this.getDescription=this.getDescription.bind(this),this.showDescription=this.showDescription.bind(this),this.addTicketBtn.addEventListener("click",this.showModal),this.closeModalBtns.forEach((function(t){return t.addEventListener("click",s.showModal)})),this.from.addEventListener("submit",this.createTicket),this.ticketRow.addEventListener("click",this.getDescription),this.ticketRow.addEventListener("click",this.showDescription),this.ticketRow.addEventListener("click",this.showModal),this.init()}var i,r,c,o,a,d,u;return i=t,(r=[{key:"init",value:function(){var t=this;this.api.getAllTickets().then((function(t){return t.json()})).then((function(e){0===e.length?t.ticketRow.innerHTML="<h2>Тикетов пока нет, добавьте новый</h2>":t.renderTickets()}))}},{key:"removeTicket",value:(u=n(regeneratorRuntime.mark((function t(e){var i,n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=e.target,n=i.closest(".desk__ticket"),t.next=4,this.api.remove(n.dataset.id);case 4:this.init(),this.modalDelete.classList.remove("show");case 6:case"end":return t.stop()}}),t,this)}))),function(t){return u.apply(this,arguments)})},{key:"renderTickets",value:(d=n(regeneratorRuntime.mark((function t(){var e,i,n=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.api.getAllTickets();case 2:return e=t.sent,t.next=5,e.json();case 5:i=t.sent,this.ticketRow.innerHTML="",i.forEach((function(t){n.ticket='<div class="desk__ticket" data-id="'.concat(t.id,'">\n            <div class="desk__ticket-content">\n              <input type="checkbox" class="desk__ticket-checkbox"/>\n              <h2 class="desk__ticket-title">').concat(t.name,'</h2>\n              <div class="desk__ticket-datetime">').concat(t.created,'</div>\n              <div class="desk__ticket-actions">\n                <button class="btn desk__ticket-edit">Edit</button>\n                <button class="btn desk__ticket-delete">Х</button>\n              </div>\n            </div>\n          </div>'),n.ticketRow.insertAdjacentHTML("beforeend",n.ticket)}));case 8:case"end":return t.stop()}}),t,this)}))),function(){return d.apply(this,arguments)})},{key:"showModal",value:function(t){var e=this,i=t.target;if(this.modalDelete.classList.remove("show"),this.modalAdd.classList.remove("show"),i.classList.contains("add-ticket-btn"))return this.inputName.value="",this.inputDesc.value="",this.modalTitle.innerText="Добавить тикет",void this.modalAdd.classList.add("show");if(i.classList.contains("desk__ticket-edit")){var n=i.closest(".desk__ticket");return this.isEditTicket=n,this.api.getTicketById(n.dataset.id).then((function(t){return t.json()})).then((function(t){e.inputName.value=t.ticket.name,e.inputDesc.value=t.ticket.description})),this.modalTitle.innerText="Изменить тикет",void this.modalAdd.classList.add("show")}i.classList.contains("desk__ticket-delete")&&(this.modalDelete.classList.add("show"),this.btnOk.addEventListener("click",(function(){e.removeTicket(t)})))}},{key:"createTicket",value:(a=n(regeneratorRuntime.mark((function t(e){var i,n,s,r=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.preventDefault(),i={name:this.inputName.value,description:this.inputDesc.value},!this.isEditTicket){t.next=9;break}return n=this.isEditTicket.querySelector(".desk__ticket-title"),s=this.isEditTicket.querySelector(".desk__ticket-desc"),this.api.editTicket(this.isEditTicket.dataset.id,i).then((function(t){return t.json()})).then((function(t){t.status&&n&&s&&(n.innerText=r.inputName.value,s.innerText=r.inputDesc.value)})),this.modalAdd.classList.remove("show"),this.isEditTicket=null,t.abrupt("return");case 9:return t.next=11,this.api.createTicket(i);case 11:this.modalAdd.classList.remove("show"),this.inputName.value="",this.inputDesc.value="",this.init();case 15:case"end":return t.stop()}}),t,this)}))),function(t){return a.apply(this,arguments)})},{key:"getDescription",value:(o=n(regeneratorRuntime.mark((function t(e){var i,n,s,r,c;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(i=e.target,n=i.closest(".desk__ticket")){t.next=4;break}return t.abrupt("return");case 4:if(!n.querySelector(".desk__ticket-desc")){t.next=7;break}return t.abrupt("return");case 7:return t.next=9,this.api.getTicketById(n.dataset.id);case 9:return s=t.sent,t.next=12,s.json();case 12:(r=t.sent).ticket.description&&(c='<div class="desk__ticket-desc">'.concat(r.ticket.description,"</div>"),n.insertAdjacentHTML("beforeend",c));case 14:case"end":return t.stop()}}),t,this)}))),function(t){return o.apply(this,arguments)})},{key:"showDescription",value:function(t){var e=t.target;if(!e.classList.contains("btn")){var i=e.closest(".desk__ticket");if(i){var n=i.querySelector(".desk__ticket-desc");n&&n.remove()}}}}])&&s(i.prototype,r),c&&s(i,c),t}())(".desk","https://hw-help-desk.herokuapp.com");window.desk=r}},i={};function n(t){var s=i[t];if(void 0!==s)return s.exports;var r=i[t]={exports:{}};return e[t](r,r.exports,n),r.exports}n.m=e,t=[],n.O=function(e,i,s,r){if(!i){var c=1/0;for(u=0;u<t.length;u++){i=t[u][0],s=t[u][1],r=t[u][2];for(var o=!0,a=0;a<i.length;a++)(!1&r||c>=r)&&Object.keys(n.O).every((function(t){return n.O[t](i[a])}))?i.splice(a--,1):(o=!1,r<c&&(c=r));if(o){t.splice(u--,1);var d=s();void 0!==d&&(e=d)}}return e}r=r||0;for(var u=t.length;u>0&&t[u-1][2]>r;u--)t[u]=t[u-1];t[u]=[i,s,r]},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},function(){var t={179:0};n.O.j=function(e){return 0===t[e]};var e=function(e,i){var s,r,c=i[0],o=i[1],a=i[2],d=0;if(c.some((function(e){return 0!==t[e]}))){for(s in o)n.o(o,s)&&(n.m[s]=o[s]);if(a)var u=a(n)}for(e&&e(i);d<c.length;d++)r=c[d],n.o(t,r)&&t[r]&&t[r][0](),t[c[d]]=0;return n.O(u)},i=self.webpackChunk=self.webpackChunk||[];i.forEach(e.bind(null,0)),i.push=e.bind(null,i.push.bind(i))}(),n.O(void 0,[202],(function(){return n(1202)}));var s=n.O(void 0,[202],(function(){return n(9207)}));s=n.O(s)}();